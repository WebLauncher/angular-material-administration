{"version":3,"file":"material-file-input.umd.js","sources":["ng://material-file-input/lib/material-file-input.component.html","ng://material-file-input/lib/material-file-input.component.ts","ng://material-file-input/lib/material-file-input.module.ts"],"sourcesContent":["<div class=\"mat-material-file-input-container\"\r\n     (click)=\"openChooseFile()\">\r\n  <input placeholder=\"{{placeholder}}\"\r\n         class=\"name\"\r\n         [value]=\"getName()\"\r\n         readonly=\"readonly\" />\r\n  <input *ngIf=\"multiple\"\r\n         type=\"file\"\r\n         #file\r\n         style=\"display: none\"\r\n         (change)=\"onFilesAdded()\"\r\n         multiple />\r\n\r\n  <input *ngIf=\"!multiple\"\r\n         type=\"file\"\r\n         #file\r\n         style=\"display: none\"\r\n         (change)=\"onFilesAdded()\" />\r\n  <button mat-stroked-button>{{buttonText}}</button>\r\n</div>\r\n","import { Component, ChangeDetectionStrategy, Input, OnDestroy, HostBinding, ElementRef, Optional, Self, ViewChild } from '@angular/core';\r\nimport { MatFormFieldControl } from '@angular/material/form-field';\r\nimport { Subject } from 'rxjs';\r\nimport { FormBuilder, NgControl, FormControl } from '@angular/forms';\r\nimport { FocusMonitor } from '@angular/cdk/a11y';\r\nimport { coerceBooleanProperty } from '@angular/cdk/coercion';\r\nimport { takeUntil } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'mat-file-input',\r\n  templateUrl: './material-file-input.component.html',\r\n  styleUrls: ['./material-file-input.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n  providers: [{ provide: MatFormFieldControl, useExisting: MatFileInputComponent }],\r\n})\r\nexport class MatFileInputComponent implements OnDestroy, MatFormFieldControl<File[]>{\r\n  static nextId = 0;\r\n  @HostBinding() id = `mat-file-input-${MatFileInputComponent.nextId++}`;\r\n  @HostBinding('class.floating')\r\n  get shouldLabelFloat() {\r\n    return this.focused || !this.empty;\r\n  }\r\n\r\n  @Input()\r\n  get placeholder() {\r\n    return this.placeholderValue;\r\n  }\r\n  set placeholder(plh) {\r\n    this.placeholderValue = plh;\r\n    this.stateChanges.next();\r\n  }\r\n  private placeholderValue = '';\r\n\r\n  @Input()\r\n  get required() {\r\n    return this.requiredValue;\r\n  }\r\n  set required(req) {\r\n    this.requiredValue = coerceBooleanProperty(req);\r\n    this.stateChanges.next();\r\n  }\r\n  private requiredValue = false;\r\n\r\n  @Input()\r\n  get disabled(): boolean { return this.disabledValue; }\r\n  set disabled(value: boolean) {\r\n    this.disabledValue = coerceBooleanProperty(value);\r\n    this.disabledValue ? this.form.disable() : this.form.enable();\r\n    this.stateChanges.next();\r\n  }\r\n  private disabledValue = false;\r\n\r\n  @Input() buttonText = 'Choose...';\r\n\r\n  errorState = false;\r\n  controlType = 'mat-material-file-input';\r\n\r\n  @HostBinding('attr.aria-describedby') describedBy = '';\r\n\r\n  @Input() multiple = false;\r\n  onChange: (value) => void;\r\n  form: FormControl;\r\n  stateChanges = new Subject<void>();\r\n  focused = false;\r\n\r\n  set value(value: File[]) {\r\n    this.form.setValue(value);\r\n    this.stateChanges.next();\r\n  }\r\n\r\n  get value() {\r\n    return this.form.value;\r\n  }\r\n\r\n  get empty() {\r\n    return !this.form.value;\r\n  }\r\n\r\n  @ViewChild('file') file;\r\n\r\n  private destroyed$ = new Subject();\r\n\r\n  constructor(\r\n    @Optional() @Self() public ngControl: NgControl,\r\n    fb: FormBuilder,\r\n    private fm: FocusMonitor,\r\n    private elRef: ElementRef<HTMLElement>\r\n  ) {\r\n    // Replace the provider from above with this.\r\n    if (this.ngControl != null) {\r\n      // Setting the value accessor directly (instead of using\r\n      // the providers) to avoid running into a circular import.\r\n      this.ngControl.valueAccessor = (this as any);\r\n    }\r\n    this.form = new FormControl(null);\r\n    this.form.valueChanges.pipe(\r\n      takeUntil(this.destroyed$)\r\n    ).subscribe(value => {\r\n      if (this.onChange) {\r\n        this.onChange(value);\r\n      }\r\n    });\r\n    fm.monitor(elRef.nativeElement, true).subscribe(origin => {\r\n      this.focused = !!origin;\r\n      this.stateChanges.next();\r\n    });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.stateChanges.complete();\r\n    this.fm.stopMonitoring(this.elRef.nativeElement);\r\n    this.destroyed$.next();\r\n    this.destroyed$.complete();\r\n  }\r\n\r\n  onContainerClick(event: MouseEvent) {\r\n    if ((event.target as Element).tagName.toLowerCase() !== 'input') {\r\n      this.elRef.nativeElement.querySelector('input').focus();\r\n    }\r\n  }\r\n\r\n  setDescribedByIds(ids: string[]) {\r\n    this.describedBy = ids.join(' ');\r\n  }\r\n\r\n  writeValue(value: File[]) {\r\n    this.value = value;\r\n  }\r\n\r\n  registerOnChange(fn: (value: any) => void) {\r\n    this.onChange = fn;\r\n  }\r\n\r\n  registerOnTouched() { }\r\n\r\n  openChooseFile() {\r\n    if (this.value) {\r\n      this.value = null;\r\n      this.file.nativeElement.value = '';\r\n    }\r\n    this.file.nativeElement.click();\r\n  }\r\n\r\n  onFilesAdded() {\r\n    const files = Object.values(this.file.nativeElement.files) as File[];\r\n    this.value = files;\r\n  }\r\n\r\n  getName() {\r\n    if (!this.value) {\r\n      return '';\r\n    }\r\n\r\n    return this.multiple ? this.value.map(file => file?.name).join(', ') : this.value[0]?.name;\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\nimport { MatFileInputComponent } from './material-file-input.component';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatButtonModule } from '@angular/material/button';\nimport { ReactiveFormsModule, FormsModule } from '@angular/forms';\nimport { CommonModule } from '@angular/common';\n\n\n\n@NgModule({\n  declarations: [MatFileInputComponent],\n  imports: [\n    CommonModule,\n    MatInputModule,\n    MatButtonModule,\n    ReactiveFormsModule,\n    FormsModule\n  ],\n  exports: [MatFileInputComponent]\n})\nexport class MatFileInputModule { }\n"],"names":["i0.ɵɵelementStart","i0.ɵɵlistener","i0.ɵɵelementEnd","Subject","FormControl","takeUntil","coerceBooleanProperty","MatFormFieldControl","i0.ɵɵelement","i0.ɵɵtemplate","i0.ɵɵtext","i0.ɵɵadvance","i0.ɵɵpropertyInterpolate","i0.ɵɵproperty","i0.ɵɵtextInterpolate","Component","ChangeDetectionStrategy","Optional","Self","HostBinding","Input","ViewChild","CommonModule","MatInputModule","MatButtonModule","ReactiveFormsModule","FormsModule","NgModule"],"mappings":"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"}